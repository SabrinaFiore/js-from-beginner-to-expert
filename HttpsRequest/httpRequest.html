<!DOCTYPE html>
<!-- run on terminal json-server --watch db.json -->

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Js exercise</title>
    <script>
      /**
       *
       * GET    -> read
       * POST   -> create
       * PUT    -> modify
       * PATCH  -> modify part of the obj
       * DELETE -> delete an obj
       *
       * */

      document.addEventListener("DOMContentLoaded", function name(params) {
        const xhr = new XMLHttpRequest();
        const url = "http://localhost:3000/posts";
       
        xhr.open("GET", url);
        xhr.send();
        xhr.onerror = (e) => {
          console.log("xhr.onerror", e);
          // alert("Error calling api");
        };
        xhr.onload = (e) => {
          // xhr.addEventListener('load', (e) => {
          const result = JSON.parse(e.target.response);
          const resultHtml = document.querySelector("#result");
          const list = document.createElement("ul");

          result.forEach((el) => {
            let li = document.createElement("li");
            li.innerHTML = el.title;
            list.appendChild(li);
          });
          resultHtml.appendChild(list);
        };
      });
    </script>
    <script>
      /**
       *
       * POST   -> create
       *
       * */

      document.addEventListener("DOMContentLoaded", function name(params) {
        const xhr = new XMLHttpRequest();
				const url = "http://localhost:3000/posts";
        const post = {
          title: "hola",
          body: "this is my obj",
        };
        xhr.open("POST", url);
        xhr.setRequestHeader("Content-type", "application/json");
        xhr.send(JSON.stringify(post));
        xhr.onerror = (e) => {
          console.log("xhr.onerror", e);
          // alert("Error calling api");
        };
        xhr.onload = (e) => {
          // xhr.addEventListener('load', (e) => {
          const result = JSON.parse(e.target.response);
          const resultHtml = document.querySelector("#result");
          const h5 = document.createElement("h5");
          h5.innerHTML = result.title;

          resultHtml.appendChild(h5);
        };
      });
    </script>
  </head>
  <body>
    <h1>Javascript ES6-ES9 - httpRequest</h1>
    <!-- <script src="./httpRequest.js"></script> -->
    <div id="result"></div>
  </body>
</html>
